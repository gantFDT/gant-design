(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{4073:function(module,exports,__webpack_require__){var api=__webpack_require__(70),content=__webpack_require__(4074);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},4074:function(module,exports,__webpack_require__){(exports=__webpack_require__(71)(!1)).push([module.i,".dragbottom {\n  border-bottom: 1px solid #1890ff !important;\n}\n.dragmiddle {\n  background: #1890ff !important;\n}\n.dragtop {\n  border-top: 1px solid #1890ff !important;\n}\n.italic {\n  font-style: italic;\n}\n",""]),module.exports=exports},4097:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var src=__webpack_require__(17),react=__webpack_require__(0),react_default=__webpack_require__.n(react),lodash=__webpack_require__(4),lodash_default=__webpack_require__.n(lodash),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__read=function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar},useGridSort=function(_a){var onBeforeMove=_a.onBeforeMove,onDragEnd=_a.onDragEnd,_b=_a.rowKey,rowKey=void 0===_b?"id":_b,_c=_a.sortKey,sortKey=void 0===_c?"path":_c,_d=_a.dragKey,dragKey=void 0===_d?"girdDragStatus":_d,targetRef=Object(react.useRef)(null);return{onRowDragMove:Object(react.useCallback)((function(event){var _a,_b,_c;if(!onBeforeMove||!onBeforeMove()){var overNode=event.overNode,y=event.y;if(overNode){targetRef.current||(targetRef.current=overNode);var rowTop=lodash_default.a.get(targetRef,"current.rowTop",0),rowHeight=lodash_default.a.get(targetRef,"current.rowHeight",0),local=rowTop+rowHeight/2>event.y?"top":"buttom";y>rowTop+rowHeight/4&&y<rowTop+rowHeight/4*3&&(local="middle"),overNode==targetRef.current?overNode.setData(__assign(__assign({},overNode.data),((_a={})[dragKey]=local,_a))):targetRef.current.setData(__assign(__assign({},targetRef.current.data),((_b={})[dragKey]=null,_b))),targetRef.current=overNode}else targetRef.current.setData(__assign(__assign({},targetRef.current.data),((_c={})[dragKey]=null,_c)))}}),[]),onRowDragEnd:Object(react.useCallback)((function(event){var _a,_b,_c,node=event.node,overNode=event.overNode;if(lodash_default.a.get(node,"data")&&lodash_default.a.get(overNode,"data")){var fromPath=node.data[sortKey],toPath=overNode.data[sortKey],parentAssert=node.data.path.length<overNode.data.path.length&&overNode.data.path.includes(node.data[rowKey]);if(fromPath===toPath||parentAssert)return void targetRef.current.setData(__assign(__assign({},targetRef.current.data),(_c={},_c[dragKey]=null,_c)));if("middle"===lodash_default.a.get(overNode,"data."+dragKey)){if(lodash_default.a.get(node,"data.parentId")===lodash_default.a.get(overNode,"data.id"))return void targetRef.current.setData(__assign(__assign({},targetRef.current.data),(_a={},_a[dragKey]=null,_a)));var children=lodash_default.a.get(overNode,"data.children");toPath=lodash_default.a.isEmpty(children)?function(path,node,rowKey){return __spread(path,[node[rowKey]])}(lodash_default.a.get(overNode,"data."+sortKey),node,rowKey):function(path,node,rowKey){return __spread(path,[node[rowKey]])}(children[children.length-1][sortKey],node,rowKey)}targetRef.current.setData(__assign(__assign({},targetRef.current.data),((_b={})[dragKey]=null,_b))),onDragEnd({node:node,overNode:overNode,fromPath:fromPath,toPath:toPath})}}),[rowKey,onDragEnd]),ruleClassRules:Object(react.useMemo)((function(){return{dragbottom:function(params){return lodash_default.a.get(params,"data."+rowKey)==lodash_default.a.get(targetRef,"current.id")&&"buttom"===lodash_default.a.get(params,"data."+dragKey)},dragmiddle:function(params){return lodash_default.a.get(params,"data."+rowKey)==lodash_default.a.get(targetRef,"current.id")&&"middle"===lodash_default.a.get(params,"data."+dragKey)},dragtop:function(params){return lodash_default.a.get(params,"data."+rowKey)==lodash_default.a.get(targetRef,"current.id")&&"top"===lodash_default.a.get(params,"data."+dragKey)}}}),[rowKey])}},sort_assign=(__webpack_require__(4073),function(){return(sort_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)}),sort_read=function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},columns=[{title:"零件名",fieldName:"partName",filter:"agMultiColumnFilter",cellRenderer:"gantGroupCellRenderer",width:150,rowDrag:!0,editConfig:{component:src.i,editable:!0,signable:!0,rules:[{required:!0,message:"零件名不能为空"}]}},{title:"Path",fieldName:"path",filter:"agTextColumnFilter",width:120},{title:"零件号",fieldName:"partNum",filter:"agTextColumnFilter",width:120,editConfig:{component:src.i,editable:!0,signable:!0,rules:[{required:!0,message:"零件号不能为空"}]}},{title:"中文名",fieldName:"zh",editConfig:{component:src.i,editable:!0,signable:!0}},{title:"英文名",fieldName:"en",editConfig:{component:src.i,editable:!0,signable:!0}}],_dataSource=[{id:"1",path:["1"],parentId:"root",partName:"发动机",partNum:"1",zh:"发动机",en:"engine"},{id:"1-1",path:["1","1-1"],parentId:"1",partName:"机体",partNum:"1.1",zh:"机体",en:"body"},{id:"1-2",path:["1","1-2"],parentId:"1",partName:"机体22",partNum:"1.2",zh:"机体",en:"body"},{id:"2",path:["2"],parentId:"root",partName:"变速器",partNum:"2",zh:"变速器",en:"transmission"}];__webpack_exports__.default=function(){var _a=sort_read(Object(react.useState)(_dataSource),2),dataSource=_a[0],_b=(_a[1],sort_read(Object(react.useState)([1,2]),2)),selectedKeys=_b[0],setSelectedKeys=_b[1],_c=sort_read(Object(react.useState)(),2),selectedRows=_c[0],setSelectedRows=_c[1],_d=sort_read(Object(react.useState)(!1),2),editable=_d[0],gridApiRef=(_d[1],Object(react.useRef)(null)),gridManagerRef=Object(react.useRef)(null),_e=useGridSort({rowKey:"id",sortKey:"path",onBeforeMove:function(){setSelectedKeys([]),setSelectedRows([])},onDragEnd:function(params){var fromPath=params.fromPath,toPath=params.toPath;params.node,params.overNode;console.log("toPath",toPath),console.log("fromPath",fromPath),alert("fromPath: "+fromPath+"\ntoPath: "+toPath)}}),onRowDragMove=_e.onRowDragMove,onRowDragEnd=_e.onRowDragEnd,ruleClassRules=_e.ruleClassRules,onReady=Object(react.useCallback)((function(params,manager){gridApiRef.current=params.api,gridManagerRef.current=manager}),[]),onSelect=Object(react.useCallback)((function(keys,rows){console.log("---\x3e",keys),setSelectedKeys(keys),setSelectedRows(rows)}),[]);return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(src.g,{title:"树形拖拽维护",type:"line"}),react_default.a.createElement(src.f,{rowkey:"id",columns:columns,dataSource:dataSource,onReady:onReady,serialNumber:!0,rowSelection:{type:"multiple",selectedKeys:selectedKeys,selectedRows:selectedRows,onSelect:onSelect},isCompute:!0,editable:editable,openEditSign:!0,treeData:!0,getDataPath:function(data){return data.path},groupSuppressAutoColumn:!0,groupSelectsChildren:!0,suppressGroupSelectParent:!0,animateRows:!0,onRowDragEnd:onRowDragEnd,onRowDragMove:onRowDragMove,rowClassRules:sort_assign({},ruleClassRules)}))}}}]);
//# sourceMappingURL=4.5e265d9112f885db0f0e.bundle.js.map