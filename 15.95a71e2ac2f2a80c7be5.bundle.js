(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{3860:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _gantd__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_grid__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(294),_header__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(88),antd__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1154),antd__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(35),faker__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2353),faker__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(faker__WEBPACK_IMPORTED_MODULE_5__),moment__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9),moment__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__),react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__),__assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},__read=function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},columns=[{title:"基本信息",fieldName:"part",children:[{title:"姓名",fieldName:"name",filter:"agMultiColumnFilter",width:150,editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_0__.i,editable:!0,signable:!0,rules:[{required:!0,whitespace:!0,message:"名称必填"},{validator:function(rules,value,cb,data){"123"!==value?cb("name错误"):cb()}}]},valueGetter:function(params){var data=params.data;return data.name?data.name+"-valueGetter":""}},{title:"性别",fieldName:"gender",filter:"agTextColumnFilter",width:120,editConfig:{component:function(params){return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_gantd__WEBPACK_IMPORTED_MODULE_0__.v,__assign({},params))},props:{dataSource:[{label:"男",value:"男"},{label:"女",value:"女"}]},editable:function(record,params){return!0},signable:!0,rules:[{required:!0,whitespace:!0,message:"性别必填"},{pattern:/男/,message:"性别错误"}]}},{title:"号码",fieldName:"tel.number",filter:"agTextColumnFilter",width:120,valueFormatter:function(params){var value=params.value;return value?value+"-valueFormatter":""},editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_0__.i,editable:!0,signable:!0}},{title:"头像",fieldName:"avatar",render:function(text,record,rowIndex){return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_7___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement("img",{src:text,style:{width:20,height:20}}))}},{title:"中文名",fieldName:"zh",filter:"agNumberColumnFilter"},{title:"英文名",fieldName:"en",filter:"agNumberColumnFilter"}]},{title:"其他信息",fieldName:"other",children:[{title:"创建人",fieldName:"createBy",filter:"agTextColumnFilter",width:120},{title:"更新人",fieldName:"updateBy",filter:"agTextColumnFilter",width:120},{title:"创建时间",fieldName:"createDate",filter:"agDateColumnFilter"},{title:"更新时间",fieldName:"updateDate",filter:"agDateColumnFilter"}]}],dataSource=new Array(100).fill({}).map((function(item,index){return{id:faker__WEBPACK_IMPORTED_MODULE_5___default.a.datatype.uuid(),name:faker__WEBPACK_IMPORTED_MODULE_5___default.a.name.firstName(),tel:{number:faker__WEBPACK_IMPORTED_MODULE_5___default.a.phone.phoneNumber()},gender:index%2==0?"男":"女",avatar:faker__WEBPACK_IMPORTED_MODULE_5___default.a.image.image(20,20),usage:faker__WEBPACK_IMPORTED_MODULE_5___default.a.datatype.number(),createDate:moment__WEBPACK_IMPORTED_MODULE_6___default()(faker__WEBPACK_IMPORTED_MODULE_5___default.a.datatype.datetime()).format("YYYY-MM-DD"),updateDate:moment__WEBPACK_IMPORTED_MODULE_6___default()(faker__WEBPACK_IMPORTED_MODULE_5___default.a.datatype.datetime()).format("YYYY-MM-DD"),createBy:faker__WEBPACK_IMPORTED_MODULE_5___default.a.name.firstName(),updateBy:faker__WEBPACK_IMPORTED_MODULE_5___default.a.name.firstName(),zh:faker__WEBPACK_IMPORTED_MODULE_5___default.a.name.lastName(),en:faker__WEBPACK_IMPORTED_MODULE_5___default.a.name.lastName(),de:faker__WEBPACK_IMPORTED_MODULE_5___default.a.name.lastName()}}));__webpack_exports__.default=function(){var _a=__read(Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(!1),2),editable=_a[0],setEditable=_a[1],_b=__read(Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)(!1),2),gridChange=_b[0],setGridChange=_b[1],_c=__read(Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)([]),2),selectedKeys=_c[0],setselectedKeys=_c[1],_d=__read(Object(react__WEBPACK_IMPORTED_MODULE_7__.useState)([]),2),selectedRows=_d[0],setSelectedRows=_d[1],apiRef=Object(react__WEBPACK_IMPORTED_MODULE_7__.useRef)(),gridManagerRef=Object(react__WEBPACK_IMPORTED_MODULE_7__.useRef)(),onReady=Object(react__WEBPACK_IMPORTED_MODULE_7__.useCallback)((function(params,manager){apiRef.current=params.api,gridManagerRef.current=manager}),[]),onEditChangeCallback=Object(react__WEBPACK_IMPORTED_MODULE_7__.useCallback)((function(isChange){setGridChange(isChange)}),[]),onSelect=Object(react__WEBPACK_IMPORTED_MODULE_7__.useCallback)((function(keys,rows){setselectedKeys(keys),setSelectedRows(rows)}),[]),onCancelEdit=Object(react__WEBPACK_IMPORTED_MODULE_7__.useCallback)((function(){if(gridChange)return antd__WEBPACK_IMPORTED_MODULE_3__.a.confirm({title:"提示",content:"grid修改内容未保存,是否结束编辑？",onOk:function(){gridManagerRef.current.cancel(),setEditable(!1)}});setEditable(!1)}),[gridChange]),onCreate=Object(react__WEBPACK_IMPORTED_MODULE_7__.useCallback)((function(selectedKeys){var createData={id:faker__WEBPACK_IMPORTED_MODULE_5___default.a.datatype.uuid()};gridManagerRef.current.create(createData,!(selectedKeys.length>0)||selectedKeys)}),[]),onTagRemove=Object(react__WEBPACK_IMPORTED_MODULE_7__.useCallback)((function(selectedKeys){gridManagerRef.current.tagRemove(selectedKeys)}),[]),onSave=Object(react__WEBPACK_IMPORTED_MODULE_7__.useCallback)((function(){return __awaiter(void 0,void 0,void 0,(function(){var _a,onDataAsyncEnd,validate,getPureData;return __generator(this,(function(_b){return _a=gridManagerRef.current,onDataAsyncEnd=_a.onDataAsyncEnd,validate=_a.validate,getPureData=_a.getPureData,_a.diff,onDataAsyncEnd((function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,validate()];case 1:return _a.sent()||gridManagerRef.current.save((function(){var dataSource=getPureData();return setEditable(!1),dataSource})),[2]}}))}))})),[2]}))}))}),[]);return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_7___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_header__WEBPACK_IMPORTED_MODULE_2__.a,{title:"侧边栏表格详情",type:"line",extra:react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_7___default.a.Fragment,null,editable&&react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a,{icon:"poweroff",type:"danger",size:"small",onClick:function(){return onCancelEdit()}}),editable&&react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a,{icon:"plus",size:"small",onClick:function(){return onCreate(selectedKeys)}}),editable&&react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a,{icon:"minus",size:"small",onClick:function(){return onTagRemove(selectedKeys)}}),editable&&react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a,{icon:"undo",size:"small",onClick:function(){return gridManagerRef.current.undo()}}),editable&&react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a,{icon:"redo",size:"small",onClick:function(){return gridManagerRef.current.redo()}}),editable&&react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a,{icon:"save",size:"small",type:"primary",onClick:function(){return onSave()}}),!editable&&react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a,{icon:"edit",size:"small",type:"primary",onClick:function(){return setEditable(!0)}}))}),react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_grid__WEBPACK_IMPORTED_MODULE_1__.b,{rowkey:"id",onReady:onReady,dataSource:dataSource,columns:columns,editable:editable,height:400,rowSelection:{selectedRows:selectedRows,onSelect:onSelect},serialNumber:!0,openEditSign:!0,editChangeCallback:onEditChangeCallback,onCellEditingChange:function(record,fieldName,newValue,oldValue,params){return console.log({record:record,fieldName:fieldName,newValue:newValue,oldValue:oldValue,params:params}),record},drawerMode:!0,defaultDrawerWidth:300,customDrawerContent:function(params){return react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_grid__WEBPACK_IMPORTED_MODULE_1__.a,__assign({},params))}}))}}}]);
//# sourceMappingURL=15.95a71e2ac2f2a80c7be5.bundle.js.map