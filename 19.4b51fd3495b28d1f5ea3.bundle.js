(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{3788:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _gantd__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),antd__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(73),antd__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(35),antd__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(284),antd__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(258),antd__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(19),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),lodash__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(4),faker__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2284),faker__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(faker__WEBPACK_IMPORTED_MODULE_8__),antd__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(2276),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},__read=function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar},columns=[{title:"零件名",fieldName:"partName",filter:"agMultiColumnFilter",cellRenderer:"gantGroupCellRenderer",width:150,editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_0__.i,editable:!0,signable:!0,rules:[{required:!0,message:"零件名不能为空"}]}},{title:"零件号",fieldName:"partNum",filter:"agTextColumnFilter",width:120,editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_0__.i,editable:!0,signable:!0,rules:[{required:!0,message:"零件号不能为空"}]}},{title:"中文名",fieldName:"zh",editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_0__.i,editable:!0,signable:!0}},{title:"英文名",fieldName:"en",editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_0__.i,editable:!0,signable:!0}}],dataSource=[{id:"1",path:["1"],partName:"发动机",partNum:"P000001",zh:"发动机",en:"engine"},{id:"1-1",path:["1","1-1"],partName:"机体",partNum:"P0000011",zh:"机体",en:"body"},{id:"2",path:["2"],partName:"变速器",partNum:"P000002",zh:"变速器",en:"transmission"}];__webpack_exports__.default=function(){var _a=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)([1,2]),2),selectedKeys=_a[0],setSelectedKeys=_a[1],_b=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)(),2),selectedRows=_b[0],setSelectedRows=_b[1],_c=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),2),editable=_c[0],setEditable=_c[1],gridApiRef=Object(react__WEBPACK_IMPORTED_MODULE_6__.useRef)(null),gridManagerRef=Object(react__WEBPACK_IMPORTED_MODULE_6__.useRef)(null),onReady=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(params,manager){gridApiRef.current=params.api,gridManagerRef.current=manager}),[]),onSelect=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(keys,rows){setSelectedKeys(keys),setSelectedRows(rows)}),[]),addRootNode=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(){return __awaiter(void 0,void 0,void 0,(function(){var id,newData,node;return __generator(this,(function(_a){return id=faker__WEBPACK_IMPORTED_MODULE_8___default.a.datatype.uuid(),newData={id:id,path:[id]},gridManagerRef.current.create(newData),(node=gridApiRef.current.getRowNode(id))&&gridApiRef.current.ensureIndexVisible(node.rowIndex),[2]}))}))}),[]),addChildNode=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(){var selectedRows=gridApiRef.current.getSelectedRows();if(1===selectedRows.length){var path=gridApiRef.current.getRowNode(selectedRows[0].id).data.path,id=faker__WEBPACK_IMPORTED_MODULE_8___default.a.datatype.uuid(),newData={id:id,path:__spread(path,[id])};gridManagerRef.current.create(newData)}else antd__WEBPACK_IMPORTED_MODULE_9__.a.warning({message:"请先选择单条数据"})}),[]),addParallelNode=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(){var selectedRows=gridApiRef.current.getSelectedRows();if(1===selectedRows.length){var node=gridApiRef.current.getRowNode(selectedRows[0].id).parent;if(Object(lodash__WEBPACK_IMPORTED_MODULE_7__.has)(node,"data")){var path=node.data.path,id=faker__WEBPACK_IMPORTED_MODULE_8___default.a.datatype.uuid(),newData={id:id,path:__spread(path,[id])};gridManagerRef.current.create(newData)}else addRootNode()}else antd__WEBPACK_IMPORTED_MODULE_9__.a.warning({message:"请先选择单条数据"})}),[]),handleSave=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(){return __awaiter(void 0,void 0,void 0,(function(){var _a,onDataAsyncEnd,validate,getPureData;return __generator(this,(function(_b){return _a=gridManagerRef.current,onDataAsyncEnd=_a.onDataAsyncEnd,validate=_a.validate,getPureData=_a.getPureData,_a.diff,onDataAsyncEnd((function(){return __awaiter(void 0,void 0,void 0,(function(){var errors;return __generator(this,(function(_a){switch(_a.label){case 0:return gridManagerRef.current.isChanged?[4,validate()]:(antd__WEBPACK_IMPORTED_MODULE_9__.a.success({message:"数据没有改变"}),[2]);case 1:return(errors=_a.sent())?(antd__WEBPACK_IMPORTED_MODULE_9__.a.warning({message:"校验不通过",description:JSON.stringify(errors,null,2)}),[2]):(gridManagerRef.current.save((function(){var dataSource=getPureData();return antd__WEBPACK_IMPORTED_MODULE_9__.a.success({message:"保存成功",description:JSON.stringify(dataSource,null,2)}),setEditable(!1),dataSource})),[2])}}))}))})),[2]}))}))}),[]);return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_6___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_gantd__WEBPACK_IMPORTED_MODULE_0__.g,{extra:react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_6___default.a.Fragment,null,editable?react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_6___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_1__.a,{title:"结束编辑"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_2__.a,{size:"small",icon:"poweroff",onClick:function(){setEditable(!1),setSelectedRows([]),setSelectedKeys([]),gridManagerRef.current.cancel()}})),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{overlay:react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a,null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a.Item,{onClick:addRootNode},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_5__.a,{type:"icon-root"}),"新增根节点"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a.Item,{disabled:Object(lodash__WEBPACK_IMPORTED_MODULE_7__.isEmpty)(selectedRows),onClick:addChildNode},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_5__.a,{type:"icon-parallel"}),"新增子节点"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_4__.a.Item,{disabled:Object(lodash__WEBPACK_IMPORTED_MODULE_7__.isEmpty)(selectedRows),onClick:addParallelNode},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_5__.a,{type:"icon-children"}),"新增兄弟节点")),placement:"bottomCenter"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_2__.a,{size:"small",icon:"plus"})),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_1__.a,{title:"删除"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_2__.a,{size:"small",icon:"minus",disabled:Object(lodash__WEBPACK_IMPORTED_MODULE_7__.isEmpty)(selectedRows),onClick:function(){return gridManagerRef.current.tagRemove(selectedKeys)}})),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_1__.a,{title:"撤销"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_2__.a,{size:"small",icon:"undo",onClick:function(){return gridManagerRef.current.undo()}})),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_1__.a,{title:"恢复"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_2__.a,{size:"small",icon:"redo",onClick:function(){return gridManagerRef.current.redo()}})),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_1__.a,{title:"保存"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_2__.a,{size:"small",icon:"save",type:"primary",onClick:handleSave}))):react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_1__.a,{title:"进入编辑"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_2__.a,{size:"small",icon:"edit",onClick:function(){return setEditable(!0)}}))),title:"树形单元格编辑",type:"line"}),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_gantd__WEBPACK_IMPORTED_MODULE_0__.f,{rowkey:"id",columns:columns,dataSource:dataSource,onReady:onReady,serialNumber:!0,rowSelection:{type:"multiple",selectedKeys:selectedKeys,selectedRows:selectedRows,onSelect:onSelect},editable:editable,openEditSign:!0,treeData:!0,getDataPath:function(data){return data.path},groupSuppressAutoColumn:!0}))}}}]);
//# sourceMappingURL=19.4b51fd3495b28d1f5ea3.bundle.js.map