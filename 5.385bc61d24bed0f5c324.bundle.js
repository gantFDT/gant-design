(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{4073:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _grid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(330),_gantd__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(17),antd__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(614),antd__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(36),mockjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(188),lodash__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(4),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},__read=function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar},RandomCreate=function(){return{ip:mockjs__WEBPACK_IMPORTED_MODULE_4__.Random.ip(),user:{name:mockjs__WEBPACK_IMPORTED_MODULE_4__.Random.first()},date:mockjs__WEBPACK_IMPORTED_MODULE_4__.Random.date("yyyy-MM-dd"),cn:mockjs__WEBPACK_IMPORTED_MODULE_4__.Random.cname(),nationality:mockjs__WEBPACK_IMPORTED_MODULE_4__.Random.pick(["China","foreign"])}},mockData=Array(100).fill("").map((function(){return RandomCreate()}));mockData=__spread(mockData);var columns=[{fieldName:"user.name",title:"英文名称",cellRenderer:"gantGroupCellRender",editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_1__.i,editable:!0,signable:!0,rules:[{required:!0,message:"姓名不能为空"}]}},{fieldName:"cn",title:"中文名称",editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_1__.i,editable:!0,signable:!0,rules:{max:4,type:"string",message:"中文名不能大于四个字符"}}},{fieldName:"date",title:"出生日期",editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_1__.d,editable:!0,signable:!0}},{fieldName:"nationality",title:"国籍",valueGetter:function(params){switch(params.data.nationality){case"China":return"中国";case"foreign":return"外籍";default:return""}},editConfig:{component:_gantd__WEBPACK_IMPORTED_MODULE_1__.v,editable:!0,signable:!0,initValueFormatter:function(params){return params.data.nationality},props:{dataSource:[{label:"中国",value:"China"},{label:"外籍",value:"foreign"}]}}}];__webpack_exports__.default=function(){var _a=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),2),editable=_a[0],setEditable=_a[1],_b=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),2),loading=_b[0],_c=(_b[1],__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)({beginIndex:0,pageSize:20}),2)),pageInfo=_c[0],setPageInfo=_c[1],_d=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)([]),2),dataSource=_d[0],setDataSource=_d[1],_e=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)(!1),2),gridChange=_e[0],setGridChange=_e[1],_f=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)([]),2),selectedKeys=_f[0],setselectedKeys=_f[1],_g=__read(Object(react__WEBPACK_IMPORTED_MODULE_6__.useState)([]),2),selectedRows=_g[0],setSelectedRows=_g[1],apiRef=Object(react__WEBPACK_IMPORTED_MODULE_6__.useRef)(),gridManagerRef=Object(react__WEBPACK_IMPORTED_MODULE_6__.useRef)(),onReady=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(params,manager){apiRef.current=params.api,gridManagerRef.current=manager}),[]),onEditChangeCallback=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(isChange){setGridChange(isChange)}),[]),queryData=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(beginIndex,pageSize){var data=mockData.slice(beginIndex,beginIndex+pageSize);setDataSource(data)}),[]),onPageChange=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(beginIndex,pageSize,page,countLimit){setPageInfo({beginIndex:beginIndex,pageSize:pageSize}),queryData(beginIndex,pageSize)}),[]),onSelect=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(keys,rows){setselectedKeys(keys),setSelectedRows(rows)}),[]),onEnterEdit=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(){setEditable(!0)}),[]),onCancelEdit=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(){if(gridChange)return antd__WEBPACK_IMPORTED_MODULE_2__.a.confirm({title:"提示",content:"grid修改内容未保存,是否结束编辑？",onOk:function(){gridManagerRef.current.cancel(),setEditable(!1)}});setEditable(!1)}),[gridChange]),onCreate=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(selectedKeys){var createData=RandomCreate();gridManagerRef.current.create(createData,!(selectedKeys.length>0)||selectedKeys)}),[]),onModify=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(selectedKeys){gridManagerRef.current.modify({ip:selectedKeys[0],user:{name:"修改之后的名称"}})}),[]),onTagRemove=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(selectedKeys){gridManagerRef.current.tagRemove(selectedKeys)}),[]),onRemove=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(selectedKeys){gridManagerRef.current.remove(selectedKeys)}),[]),onSave=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(){return __awaiter(void 0,void 0,void 0,(function(){var _a,onDataAsyncEnd,validate,getPureData;return __generator(this,(function(_b){return _a=gridManagerRef.current,onDataAsyncEnd=_a.onDataAsyncEnd,validate=_a.validate,getPureData=_a.getPureData,_a.diff,onDataAsyncEnd((function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,validate()];case 1:return _a.sent()||gridManagerRef.current.save((function(){var dataSource=getPureData();return setEditable(!1),dataSource})),[2]}}))}))})),[2]}))}))}),[]),getContextMenuItems=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(res){var _a=res.context,gridManager=_a.gridManager,globalEditable=_a.globalEditable,selectedKeys=res.selectedKeys;return globalEditable?[{name:"保存",action:onSave},{name:"新增",action:function(){return onCreate(selectedKeys)}},{name:"标记删除",action:function(){return onTagRemove(selectedKeys)}},{name:"删除",action:function(){return onRemove(selectedKeys)}},{name:"恢复",action:function(){return gridManager.cancel()}},{name:"结束编辑",action:onCancelEdit}]:[{name:"进入编辑",action:onEnterEdit}]}),[]),onCellEditingChange=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(record,fieldName,newValue,oldValue,params){return record}),[]);Object(react__WEBPACK_IMPORTED_MODULE_6__.useEffect)((function(){queryData(0,20)}),[]);var processCellFromClipboard=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(params){var column=params.column,node=params.node;return console.log("processCellFromClipboard-----\x3e",params,Object(lodash__WEBPACK_IMPORTED_MODULE_5__.cloneDeep)(params.node.data)),Object(lodash__WEBPACK_IMPORTED_MODULE_5__.get)(node,"data."+Object(lodash__WEBPACK_IMPORTED_MODULE_5__.get)(column,"colId"))}),[]),processCellForClipboard=Object(react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((function(params){return params.value}),[]);return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_6___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_gantd__WEBPACK_IMPORTED_MODULE_1__.g,{extra:react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_6___default.a.Fragment,null,editable?react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_6___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"poweroff",onClick:onCancelEdit},"结束编辑"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"plus",onClick:function(){return onCreate(selectedKeys)}},"创建"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"font-colors",onClick:function(){return onModify(selectedKeys)}},"修改"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"minus",onClick:function(){return onTagRemove(selectedKeys)}},"标记删除"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"delete",onClick:function(){return onRemove(selectedKeys)}},"删除"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"undo",onClick:function(){return gridManagerRef.current.undo()}},"撤销"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"redo",onClick:function(){return gridManagerRef.current.redo()}},"恢复"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"save",onClick:onSave},"保存")):react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(antd__WEBPACK_IMPORTED_MODULE_3__.a,{size:"small",icon:"edit",onClick:onEnterEdit},"进入编辑")),title:"单元格编辑",type:"line"}),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_grid__WEBPACK_IMPORTED_MODULE_0__.b,{rowkey:"ip",loading:loading,columns:columns,editable:editable,dataSource:dataSource,serialNumber:!0,processCellFromClipboard:processCellFromClipboard,processCellForClipboard:processCellForClipboard,rowSelection:{selectedRows:selectedRows,onSelect:onSelect},pagination:{total:mockData.length,beginIndex:pageInfo.beginIndex,pageSize:pageInfo.pageSize,onChange:onPageChange},onCellEditingChange:onCellEditingChange,rowBuffer:20,groupSuppressAutoColumn:!0,editChangeCallback:onEditChangeCallback,onReady:onReady,openEditSign:!0,context:{onCancelEdit:onCancelEdit,onEnterEdit:onEnterEdit,onCreate:onCreate,onRemove:onRemove,onTagRemove:onTagRemove},getContextMenuItems:getContextMenuItems,enableCellTextSelection:!1,onCellChanged:function(params){console.log("onCellChanged----\x3e",params)},enableRangeSelection:!0}))}}}]);
//# sourceMappingURL=5.385bc61d24bed0f5c324.bundle.js.map